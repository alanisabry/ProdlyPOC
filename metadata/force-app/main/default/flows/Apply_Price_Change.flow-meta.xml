<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <apiVersion>49.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <description>Adds default price for each loop element to a new variable.</description>
        <name>Add_Default_Price</name>
        <label>Add Default Price</label>
        <locationX>4439</locationX>
        <locationY>1084</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllOneOffProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_p_TotalDefaultPricePerOneOffLineItem</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CurrentOneOffDiscount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>One_off_to_assign_sum_of_default_price.Discount_percentage__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CounterOneOffLineItems</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>One_off_to_assign_sum_of_default_price</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Default Price per each MRR item (Quantity * Default Price) to the collection variable. Used in the amount-based branch.</description>
        <name>Add_Default_Price_per_MRR_to_the_variable</name>
        <label>Add Default Price per MRR to the variable.</label>
        <locationX>2771</locationX>
        <locationY>611</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllARRProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_a_TotalDefaultPricePerMRRLineItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_every_MRR_product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Default Price per each One-Off item (Quantity * Default Price) to the collection variable. Used in the amount-based branch.</description>
        <name>Add_Default_Price_per_One_off_to_the_variable</name>
        <label>Add Default Price per One-off to the variable.</label>
        <locationX>2505</locationX>
        <locationY>606</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllOneOffProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_a_TotalDefaultPricePerOneOffLineItem</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_every_One_Off_product</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds default price of each MRR product to the variable to use further in the calculations.</description>
        <name>Add_Default_Price_per_product_to_Total_Default_Price_variable</name>
        <label>Add Default Price per product to Total Default Price variable</label>
        <locationX>4453</locationX>
        <locationY>426</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllARRProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_p_TotalARRDefaultPricePerLineItem</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CounterMRRLineItems</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CurrentMRRDiscount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>For_every_MRR_product_percentage.Discount_percentage__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_every_MRR_product_percentage</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Default Price of each MRR product to the Total Default Price of MRR products. Used instead of a roll-up summary field on the opportunity.</description>
        <name>Add_Default_Price_to_Total_MRR_Default_Price</name>
        <label>Add Default Price to Total MRR Default Price</label>
        <locationX>4494</locationX>
        <locationY>1720</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllARRProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_p_TotalDefaultPricePerARRAllLineItem</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CounterMRRLineItems</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CurrentMRRDiscount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>For_each_of_all_OLI.Discount_percentage__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_each_of_all_OLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Default Price of each One-off product to the Total Default Price of One Off products. Used instead of a roll-up summary field on the opportunity.</description>
        <name>Add_Default_Price_to_Total_One_Off_Default_Price</name>
        <label>Add Default Price to Total One-Off Default Price</label>
        <locationX>4267</locationX>
        <locationY>1726</locationY>
        <assignmentItems>
            <assignToReference>cur_DefaultPriceAllOneOffProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_p_TotalDefaultPricePerARRAllLineItem</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CounterOneOffLineItems</assignToReference>
            <operator>Add</operator>
            <value>
                <numberValue>1.0</numberValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>num_p_CurrentOneOffDiscount</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>For_each_of_all_OLI.Discount_percentage__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_each_of_all_OLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds newly found record to a collection of MRR Opportunity Line Items from that opportunity.</description>
        <name>Add_to_a_new_MRR_OLI_collection</name>
        <label>Add to a new Opportunity Product collection</label>
        <locationX>684</locationX>
        <locationY>300</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OpportunityLineItemsForSelectedLogic</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Get_OLI_record</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_each_element_in_the_ID_text_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds newly found record to a collection of One-Off Opportunity Line Items from that opportunity.</description>
        <name>Add_to_a_new_OneOff_OLI_collection</name>
        <label>Add to a new Opportunity Product collection</label>
        <locationX>725</locationX>
        <locationY>1601</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OpportunityLineItemsForSelectedLogic</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Get_OLI_OneOff</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_each_element_in_the_OneOff_D_text_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds updated OLI to a new collection that later will be updated in one go.</description>
        <name>Add_to_OLI_to_update_percentage</name>
        <label>Add to OLI to update</label>
        <locationX>5450</locationX>
        <locationY>1002</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>For_each_selected_OLI_percentage</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_each_selected_OLI_percentage</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds updated record to the collection of records to be updated.</description>
        <name>Add_to_the_list_of_OLIs_to_update_All</name>
        <label>Add to the list of OLIs to Update - All</label>
        <locationX>5162</locationX>
        <locationY>1839</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_All_OLI</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Apply_Price_Change_to_All_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds update record to the list of OLIs that will be updated later in one go.</description>
        <name>Add_to_the_list_of_OLIs_to_update_All_MRR</name>
        <label>Add to the list of OLIs to update</label>
        <locationX>1023</locationX>
        <locationY>739</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Update_Sales_Price_for_MRR_products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Sales_Price_for_MRR_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds to the list of OLIs that will be updated in one go at a later step.</description>
        <name>Add_to_the_list_of_OLIs_to_update_Discount_OneOff</name>
        <label>Add to the list of OLIs to update</label>
        <locationX>5102</locationX>
        <locationY>1432</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_OLI_OneOff</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Apply_Discount_to_One_Off_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds updated record to the collection of records that will be updated in one go at a later stage.</description>
        <name>Add_to_the_list_of_OLIs_to_update_OneOff</name>
        <label>Add to the list of OLIs to update</label>
        <locationX>98</locationX>
        <locationY>1656</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Apply_OneOff_Price_Change</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Apply_OneOff_Price_Change</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns updated OLI to the list of records that will be updated in one go at a later stage.</description>
        <name>Add_to_the_list_of_OLIs_to_update_Selected_MRR</name>
        <label>Add to the list of OLIs to update</label>
        <locationX>129</locationX>
        <locationY>330</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Apply_price_change</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Apply_price_change</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds updated record to the list that will be updated in one action at a later stage.</description>
        <name>Add_to_the_list_of_OneOff_OLIs_to_update</name>
        <label>Add to the list of OLIs to update</label>
        <locationX>958</locationX>
        <locationY>1088</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Update_Sales_Price_for_One_off_products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Sales_Price_for_One_off_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Quantity * Sales Price to the variable that stores Total Sales price of all selected products.</description>
        <name>Add_to_the_Total_Sales_price_variable</name>
        <label>Add to the Total Sales price variable</label>
        <locationX>340</locationX>
        <locationY>271</locationY>
        <assignmentItems>
            <assignToReference>cur_TotalSalesPriceSelectedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_a_ARRTotalSalesPricePerProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Calculate_Discount_Proportion</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds Quantity * Sales Price to the variable that stores Total Sales price of all selected products.</description>
        <name>Add_to_the_Total_Sales_Price_variable_OneOff</name>
        <label>Add to the Total Sales Price variable</label>
        <locationX>400</locationX>
        <locationY>1667</locationY>
        <assignmentItems>
            <assignToReference>cur_TotalSalesPriceSelectedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>cur_a_ARRTotalSalesPricePerProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>To_calculate_Discount_Proportion_One_off</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign &quot;Decrease&quot; value to the variable that is later used in calculating Sales Prices for products.</description>
        <name>Assign_Decrease_Type</name>
        <label>Assign Decrease Type</label>
        <locationX>3864</locationX>
        <locationY>891</locationY>
        <assignmentItems>
            <assignToReference>txt_p_ChoiceType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Decrease</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Choose_Discount_Reason_P</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign &quot;Increase&quot; value to the variable that is later used in calculating Sales Prices for products.</description>
        <name>Assign_Increase_Type</name>
        <label>Assign Increase Type</label>
        <locationX>3868</locationX>
        <locationY>778</locationY>
        <assignmentItems>
            <assignToReference>txt_p_ChoiceType</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Increase</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Kind_of_discount_selected</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Updates Sales Price of each product to reflect the discount/increase.</description>
        <name>Assign_new_MRR_Sales_Price</name>
        <label>Assign new MRR Sales Price</label>
        <locationX>5139</locationX>
        <locationY>453</locationY>
        <assignmentItems>
            <assignToReference>Loop_OLI_MRR.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>cur_p_NewSalesPriceARRProducts</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loop_OLI_MRR.Recurring_Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Is_it_recurring_MRR_discount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>MRR_All_in_One</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign new Sales Price to each One-off OLI.</description>
        <name>Assign_new_One_Off_Sales_Price</name>
        <label>Assign new One-Off Sales Price</label>
        <locationX>4880</locationX>
        <locationY>1433</locationY>
        <assignmentItems>
            <assignToReference>Loop_OLI_OneOff.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_p_NewSalesPriceOneoffProducts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OLIs_to_update_Discount_OneOff</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds found record to the new collection.</description>
        <name>Assign_to_a_new_Opportunity_Product_collection_0</name>
        <label>Assign to a new Opportunity Product collection</label>
        <locationX>5146</locationX>
        <locationY>949</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OpportunityLineItemsForSelectedLogic</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Get_OLI_Record_All</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>For_every_element_from_the_text_collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Flow adds first 18 symbols, which represent one Opportunity Line Item, to a new text collection. Each 18 symbols thus will represent one element of this collection, which can be looped over at a later stage.</description>
        <name>Assign_to_text_collection_of_selected_MRR_IDs</name>
        <label>First OLI to txt collection of selected MRR IDs</label>
        <locationX>1109</locationX>
        <locationY>232</locationY>
        <assignmentItems>
            <assignToReference>txt_col_SelectedProductsID</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>txt_both_FirstSelectedProductID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Remove_first_18_symbols_1_OLI</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Adds first OLI (first 18 symbols from the cleaned string with selected products&apos; IDs)  as a separate element to a text collection.</description>
        <name>First_OLI_to_a_txt_collection</name>
        <label>First OLI to a txt collection</label>
        <locationX>4792</locationX>
        <locationY>1005</locationY>
        <assignmentItems>
            <assignToReference>txt_col_SelectedProductsID</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>txt_both_FirstSelectedProductID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Remove_first_18_symbols_one_OLI_All</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Flow adds first 18 symbols, which represent one Opportunity Line Item, to a new text collection. Each 18 symbols thus will represent one element of this collection, which can be looped over at a later stage.</description>
        <name>First_OLI_to_txt_collection_of_selected_OneOff_IDs</name>
        <label>First OLI to txt collection of selected MRR IDs</label>
        <locationX>1162</locationX>
        <locationY>1714</locationY>
        <assignmentItems>
            <assignToReference>txt_col_SelectedProductsID</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>txt_both_FirstSelectedProductID</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Remove_first_18_symbols_one_OLI_OneOff</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Stores each updated MRR Opportunity Line Item in a new collection that will be updated later.</description>
        <name>MRR_All_in_One</name>
        <label>MRR All in One</label>
        <locationX>5396</locationX>
        <locationY>455</locationY>
        <assignmentItems>
            <assignToReference>rec_col_OLIToUpdate</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Loop_OLI_MRR</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Apply_Price_Change_to_MRR_products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns a text variable that contains only IDs of the selected One-Off Opportunity Line Items without any additional symbols.</description>
        <name>Raw_selected_OneOff_IDs_to_text_variable</name>
        <label>Raw selected products IDs to text variable</label>
        <locationX>1212</locationX>
        <locationY>1454</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_both_RawProductsCleaned</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_One_off_products_parsed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns a text variable that contains only IDs of the selected MRR Opportunity Line Items without any additional symbols.</description>
        <name>Raw_selected_products_IDs_to_text_varaiable</name>
        <label>Raw selected products IDs to text variable</label>
        <locationX>1141</locationX>
        <locationY>410</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_both_RawProductsCleaned</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_MRR_products_parsed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns a text variable that contains only IDs of the selected MRR Opportunity Line Items without any additional symbols.</description>
        <name>Raw_selected_products_IDs_to_text_variable_All</name>
        <label>Raw selected products IDs to text variable</label>
        <locationX>4740</locationX>
        <locationY>813</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_both_RawProductsCleaned</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_products_parsed_All</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns the same string with all selected MRR products minus first 18 symbols, which represent first OLI.</description>
        <name>Remove_first_18_symbols_1_OLI</name>
        <label>Remove first 18 symbols (one OLI)</label>
        <locationX>929</locationX>
        <locationY>231</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_a_RemoveFirstOLIFromSelectedMRRProducts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_MRR_products_parsed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns the same string with all selected MRR products minus first 18 symbols, which represent first OLI.</description>
        <name>Remove_first_18_symbols_one_OLI_All</name>
        <label>Remove first 18 symbols (one OLI)</label>
        <locationX>4896</locationX>
        <locationY>1004</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_a_RemoveFirstOLIFromSelectedMRRProducts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_products_parsed_All</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns the same string with all selected One-Off products minus first 18 symbols, which represent first OLI.</description>
        <name>Remove_first_18_symbols_one_OLI_OneOff</name>
        <label>Remove first 18 symbols (one OLI)</label>
        <locationX>1024</locationX>
        <locationY>1714</locationY>
        <assignmentItems>
            <assignToReference>str_both_SelectedRawProducts</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_a_RemoveFirstOLIFromSelectedMRRProducts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>All_One_off_products_parsed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns all selected products as a sting in the format &quot;FirstOLIID; SecondOLIId; ThirdOLIID&quot; etc.</description>
        <name>Selected_All_products_to_string</name>
        <label>Selected products to a text variable</label>
        <locationX>4598</locationX>
        <locationY>814</locationY>
        <assignmentItems>
            <assignToReference>txt_RawSelectedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Products_Selected_Discount_percentage</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Raw_selected_products_IDs_to_text_variable_All</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns all selected products as a sting in the format &quot;FirstOLIID; SecondOLIId; ThirdOLIID&quot; etc.</description>
        <name>Selected_MRR_products_to_string</name>
        <label>Selected products to a text variable</label>
        <locationX>1298</locationX>
        <locationY>411</locationY>
        <assignmentItems>
            <assignToReference>txt_RawSelectedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Products</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Raw_selected_products_IDs_to_text_varaiable</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Returns all selected One-off products as a sting in the format &quot;FirstOLIID; SecondOLIId; ThirdOLIID&quot; etc.</description>
        <name>Selected_One_off_to_string</name>
        <label>Selected products to a text variable</label>
        <locationX>1408</locationX>
        <locationY>1455</locationY>
        <assignmentItems>
            <assignToReference>txt_RawSelectedProducts</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Products_OneOff</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Raw_selected_OneOff_IDs_to_text_variable</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Stores Quantity and Current Sales Price of each selected OLI in separate variables.</description>
        <name>Store_Sales_Price_and_Quantity_of_OLI</name>
        <label>Store Sales Price and Quantity of OLI</label>
        <locationX>492</locationX>
        <locationY>272</locationY>
        <assignmentItems>
            <assignToReference>num_a_QuantitySelectedProduct</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calculate_Discount_Proportion.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>cur_SalesPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Calculate_Discount_Proportion.Sales_Price_ARR__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_Total_Sales_price_variable</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Stores Quantity and Current Sales Price of each selected OLI in separate variables.</description>
        <name>Store_Sales_Price_and_Quantity_of_OneOff_OLI</name>
        <label>Store Sales Price and Quantity of OLI</label>
        <locationX>509</locationX>
        <locationY>1666</locationY>
        <assignmentItems>
            <assignToReference>num_a_QuantitySelectedProduct</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>To_calculate_Discount_Proportion_One_off.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>cur_SalesPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>To_calculate_Discount_Proportion_One_off.Sales_Price_ARR__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_Total_Sales_Price_variable_OneOff</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns new Sales Price and whether the discount is recurring or not to all products.</description>
        <name>Update_Sales_Price_of_each_OLI</name>
        <label>Update  Sales Price of each OLI</label>
        <locationX>5033</locationX>
        <locationY>1841</locationY>
        <assignmentItems>
            <assignToReference>Loop_All_OLI.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_p_NewSalesPriceAllProducts</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Loop_All_OLI.Recurring_Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>txt_p_RecurringDiscount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OLIs_to_update_All</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Updates Sales Price of each MRR product from the collection.</description>
        <name>Update_Sales_Price_of_MRR_OLI</name>
        <label>Update Sales Price of MRR OLI</label>
        <locationX>926</locationX>
        <locationY>629</locationY>
        <assignmentItems>
            <assignToReference>Update_Sales_Price_for_MRR_products.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_a_NewSalesPriceMRRProduct</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Update_Sales_Price_for_MRR_products.Recurring_Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Recurring_discount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OLIs_to_update_All_MRR</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Update_Sales_Price_of_One_off</name>
        <label>Update Sales Price of OLI</label>
        <locationX>957</locationX>
        <locationY>1270</locationY>
        <assignmentItems>
            <assignToReference>Update_Sales_Price_for_One_off_products.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_a_NewSalesPriceOneOffProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OneOff_OLIs_to_update</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns new Sales Price and whether it is a recurring change or not to selected products.</description>
        <name>Update_Sales_Price_of_Selected_MRR_OLIs</name>
        <label>Update Sales Price of Selected MRR OLIs</label>
        <locationX>50</locationX>
        <locationY>201</locationY>
        <assignmentItems>
            <assignToReference>Apply_price_change.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_a_NewSalesPriceSelectedARRProducts</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Apply_price_change.Recurring_Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Is_it_recurring_discount</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OLIs_to_update_Selected_MRR</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assigns new Sales Price to selected products.</description>
        <name>Update_Sales_Price_of_Selected_OneOff_OLIs</name>
        <label>Update Sales Price of Selected OneOff OLIs</label>
        <locationX>203</locationX>
        <locationY>1743</locationY>
        <assignmentItems>
            <assignToReference>Apply_OneOff_Price_Change.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_a_NewSalesPriceSelectedOneOffProducts</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_the_list_of_OLIs_to_update_OneOff</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Updates Sales Price of each product based on the Default Price. The discount is reflected on the custom field &quot;Discount (%)&quot;.</description>
        <name>Update_Sales_Price_selected_percentage</name>
        <label>Update Sales Price</label>
        <locationX>5338</locationX>
        <locationY>995</locationY>
        <assignmentItems>
            <assignToReference>For_each_selected_OLI_percentage.Sales_Price_ARR__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>num_p_NewSalesPriceSelectedProducts</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>For_each_selected_OLI_percentage.Recurring_Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Recurring_discount_for_all</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_to_OLI_to_update_percentage</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>All_products</name>
        <choiceText>All products</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Applytoallproducts</name>
        <choiceText>Apply to all products</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Applytocertainproducts</name>
        <choiceText>Apply to certain products</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <description>Choice that allows to select an amount that will be distributed among products.</description>
        <name>choiceAmounBased</name>
        <choiceText>Amount-based</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <description>Choice that represents the percentage-based discount.</description>
        <name>choicePercentageBased</name>
        <choiceText>Percentage-based</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Decrease_Choice</name>
        <choiceText>Decrease</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Increase_Choice</name>
        <choiceText>Increase</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Individual_OneOff_Choice</name>
        <choiceText>Specific One-off products</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Individual_Products_Choice</name>
        <choiceText>Individual products (select them)</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>MRR_products_Choice</name>
        <choiceText>ARR products only</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>One_off_products_Choice</name>
        <choiceText>One-Off products only</choiceText>
        <dataType>String</dataType>
    </choices>
    <choices>
        <name>Specific_MRR_Products_Choice</name>
        <choiceText>Specific ARR products</choiceText>
        <dataType>String</dataType>
    </choices>
    <decisions>
        <description>Checks whether the string of selected MRR products IDs still has any symbols left. If the string is blank, it means that all OLI IDs from the string were added as elements to a usable text collection and can be looped over in the next element.</description>
        <name>All_MRR_products_parsed</name>
        <label>All MRR products parsed?</label>
        <locationX>1006</locationX>
        <locationY>412</locationY>
        <defaultConnector>
            <targetReference>Assign_to_text_collection_of_selected_MRR_IDs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_all_products_parsed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>str_both_SelectedRawProducts</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>For_each_element_in_the_ID_text_collection</targetReference>
            </connector>
            <label>Yes, all products parsed</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks whether the string of selected One-Off products IDs still has any symbols left. If the string is blank, it means that all OLI IDs from the string were added as elements to a usable text collection and can be looped over in the next element.</description>
        <name>All_One_off_products_parsed</name>
        <label>All One-off products parsed?</label>
        <locationX>1027</locationX>
        <locationY>1456</locationY>
        <defaultConnector>
            <targetReference>First_OLI_to_txt_collection_of_selected_OneOff_IDs</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_all_one_off_parsed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>str_both_SelectedRawProducts</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>For_each_element_in_the_OneOff_D_text_collection</targetReference>
            </connector>
            <label>Yes, all One-off products parsed</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks whether the string has any values. If it is blank, it means that a collection of text values includes all IDs, and the flow can move further.</description>
        <name>All_products_parsed_All</name>
        <label>All products parsed?</label>
        <locationX>4878</locationX>
        <locationY>815</locationY>
        <defaultConnector>
            <targetReference>First_OLI_to_a_txt_collection</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No, some products left</defaultConnectorLabel>
        <rules>
            <name>Yes_all_products_parsed_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>str_both_SelectedRawProducts</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>For_every_element_from_the_text_collection</targetReference>
            </connector>
            <label>Yes, all products parsed</label>
        </rules>
    </decisions>
    <decisions>
        <description>First decision that has two elements: user selected to apply the discount either in the form of the amount or percentage.</description>
        <name>decision_Type_of_Discount</name>
        <label>What type of discount was selected?</label>
        <locationX>3256</locationX>
        <locationY>818</locationY>
        <defaultConnector>
            <targetReference>Choose_Discount</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Percentage-based</defaultConnectorLabel>
        <rules>
            <name>Amount_based</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>choiceAmounBased</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>get_Opportunity_for_amount_branch</targetReference>
            </connector>
            <label>Amount-based</label>
        </rules>
    </decisions>
    <decisions>
        <name>Increase_or_Decrease</name>
        <label>Increase or Decrease?</label>
        <locationX>2027</locationX>
        <locationY>614</locationY>
        <defaultConnector>
            <targetReference>Type_of_MRR_discount_decision</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Increase</defaultConnectorLabel>
        <rules>
            <name>Decrease_MRR</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>num_a_NewARRMinusOldMRR</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Choose_Discount_Reason_A_MRR</targetReference>
            </connector>
            <label>Decrease</label>
        </rules>
    </decisions>
    <decisions>
        <name>Increase_or_Decrease_A_OneOff</name>
        <label>Increase or Decrease?</label>
        <locationX>2030</locationX>
        <locationY>1208</locationY>
        <defaultConnector>
            <targetReference>Type_of_One_off_discount_selected</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Increase</defaultConnectorLabel>
        <rules>
            <name>Decrease_A_OneOff</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>num_a_NewOneOffMinusOldOneOff</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Choose_Discount_Reason_A_OneOff</targetReference>
            </connector>
            <label>Decrease</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks whether the sum of Sales Prices of selected products is bigger than the difference between current MRR and desired MRR.</description>
        <name>Is_Sales_price_positive_MRR</name>
        <label>Is Sales price positive?</label>
        <locationX>228</locationX>
        <locationY>214</locationY>
        <defaultConnector>
            <targetReference>Invalid_Discount</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_positive</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>num_a_NewSalesPriceSelectedARRProducts</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Sales_Price_of_Selected_MRR_OLIs</targetReference>
            </connector>
            <label>Yes, positive</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Sales_price_positive_OneOff</name>
        <label>Is Sales price positive?</label>
        <locationX>280</locationX>
        <locationY>1624</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_positive_One_Off</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>num_a_NewSalesPriceSelectedOneOffProducts</leftValueReference>
                <operator>GreaterThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Sales_Price_of_Selected_OneOff_OLIs</targetReference>
            </connector>
            <label>Yes, positive</label>
        </rules>
    </decisions>
    <decisions>
        <name>Kind_of_discount_selected</name>
        <label>Kind of discount selected</label>
        <locationX>4274</locationX>
        <locationY>811</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>One_Off_discount</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>One_off_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_One_Off_product</targetReference>
            </connector>
            <label>One-Off discount</label>
        </rules>
        <rules>
            <name>MRR_discount</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MRR_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_MRR_line_items</targetReference>
            </connector>
            <label>MRR discount</label>
        </rules>
        <rules>
            <name>All_products_discount</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>All_products</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_All_Opportunity_Line_Items</targetReference>
            </connector>
            <label>All products</label>
        </rules>
        <rules>
            <name>Individual_products</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Individual_Products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_products_for_discount_Percentage</targetReference>
            </connector>
            <label>Individual products</label>
        </rules>
    </decisions>
    <decisions>
        <description>Indicates whether the current loop item is MRR or One-Off product.</description>
        <name>OLI_type</name>
        <label>OLI type?</label>
        <locationX>4373</locationX>
        <locationY>1929</locationY>
        <defaultConnector>
            <targetReference>Add_Default_Price_to_Total_One_Off_Default_Price</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>One-off Line Item</defaultConnectorLabel>
        <rules>
            <name>MRR_Line_Item</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>For_each_of_all_OLI.For_Renewal__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Default_Price_to_Total_MRR_Default_Price</targetReference>
            </connector>
            <label>MRR Line Item</label>
        </rules>
    </decisions>
    <decisions>
        <name>Sales_Price_great_than_0_MRR</name>
        <label>Sales Price &gt; 0?</label>
        <locationX>1154</locationX>
        <locationY>622</locationY>
        <defaultConnector>
            <targetReference>Update_Sales_Price_for_MRR_products</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Sales_Price_is_positive</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Update_Sales_Price_for_MRR_products.UnitPrice</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Sales_Price_of_MRR_OLI</targetReference>
            </connector>
            <label>Sales Price is positive</label>
        </rules>
    </decisions>
    <decisions>
        <name>Sales_Price_greater_than_0_OneOff</name>
        <label>Sales Price &gt; 0?</label>
        <locationX>1153</locationX>
        <locationY>1281</locationY>
        <defaultConnector>
            <targetReference>Update_Sales_Price_for_One_off_products</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Sales_Price_is_positive_OneOff_amount</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Update_Sales_Price_for_One_off_products.UnitPrice</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Sales_Price_of_One_off</targetReference>
            </connector>
            <label>Sales Price is positive</label>
        </rules>
    </decisions>
    <decisions>
        <description>After user select how they want to apply amount-based discount, the decision ahs 4 branches: all MRR, selected MRR, all One-off, selected One-off</description>
        <name>Type_of_discount_decision</name>
        <label>Type of discount selected</label>
        <locationX>2151</locationX>
        <locationY>816</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Apply_to_selected_One_Off</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Individual_OneOff_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_New_Sales_Price_0</targetReference>
            </connector>
            <label>Apply to selected One-off</label>
        </rules>
        <rules>
            <name>Apply_to_MRR</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MRR_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_New_Sales_Price</targetReference>
            </connector>
            <label>Apply to MRR</label>
        </rules>
        <rules>
            <name>Apply_to_One_off</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>One_off_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_New_Sales_Price_0</targetReference>
            </connector>
            <label>Apply to One-off</label>
        </rules>
        <rules>
            <name>Apply_to_selected_MRR</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Specific_MRR_Products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_New_Sales_Price</targetReference>
            </connector>
            <label>Apply to selected MRR</label>
        </rules>
    </decisions>
    <decisions>
        <name>Type_of_MRR_discount_decision</name>
        <label>Type of MRR discount selected</label>
        <locationX>1541</locationX>
        <locationY>613</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Apply_to_MRR_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MRR_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Discount_Confirmation_Amount</targetReference>
            </connector>
            <label>Apply to MRR</label>
        </rules>
        <rules>
            <name>Apply_to_selected_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Specific_MRR_Products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_products_for_price_change_MRR</targetReference>
            </connector>
            <label>Apply to selected</label>
        </rules>
    </decisions>
    <decisions>
        <name>Type_of_One_off_discount_selected</name>
        <label>Type of One-off discount selected</label>
        <locationX>1562</locationX>
        <locationY>1213</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>All_One_off</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>One_off_products_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>DiscountConfirmationOneoff</targetReference>
            </connector>
            <label>All One-off</label>
        </rules>
        <rules>
            <name>Selected_One_off</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Individual_OneOff_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Select_products_for_price_change</targetReference>
            </connector>
            <label>Selected One-off</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_price_change_type_selected</name>
        <label>Which price change type selected?</label>
        <locationX>3664</locationX>
        <locationY>820</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Decrease</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Decrease_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Decrease_Type</targetReference>
            </connector>
            <label>Decrease</label>
        </rules>
        <rules>
            <name>Increase</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Increase_Choice</leftValueReference>
                <operator>WasSelected</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Increase_Type</targetReference>
            </connector>
            <label>Increase</label>
        </rules>
    </decisions>
    <description>BODEV-927: Replaced ARR from products with ARR</description>
    <dynamicChoiceSets>
        <name>Discount_Reason_Choice_Set</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Discount_reasons__c</picklistField>
        <picklistObject>Opportunity</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <name>Recurring_Discount_CS</name>
        <dataType>Picklist</dataType>
        <displayField xsi:nil="true"/>
        <object xsi:nil="true"/>
        <picklistField>Recurring_Discount__c</picklistField>
        <picklistObject>OpportunityLineItem</picklistObject>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <description>Choice set that includes all MRR OLIs from the opportunity. Used in the amount branch to select products frorthe price change.</description>
        <name>set_a_MRRLineItems</name>
        <dataType>String</dataType>
        <displayField>Product_Name_for_the_Flow__c</displayField>
        <filterLogic>and</filterLogic>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <description>Choice set that includes all One-off products from the opportunity. Used for selecting products in the amount branch.</description>
        <name>set_a_OneOffLineItems</name>
        <dataType>String</dataType>
        <displayField>Product_Name_for_the_Flow__c</displayField>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <dynamicChoiceSets>
        <description>Choice set that includes all products from the opportunity. Used in the percentage branch to select specific products.</description>
        <name>set_p_AllLineItems</name>
        <dataType>String</dataType>
        <displayField>Product_Name_for_the_Flow__c</displayField>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
        <valueField>Id</valueField>
    </dynamicChoiceSets>
    <formulas>
        <description>Indicates Quantity * Sales Price of each selected product.</description>
        <name>cur_a_ARRTotalSalesPricePerProduct</name>
        <dataType>Currency</dataType>
        <expression>{!num_a_QuantitySelectedProduct} * {!cur_SalesPrice}</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Contains Total Default Price / Sales Price per line item, not per unit.</description>
        <name>cur_a_TotalDefaultPricePerMRRLineItem</name>
        <dataType>Currency</dataType>
        <expression>IF({!For_every_MRR_product.Default_Price_ARR__c} &lt;&gt; 0, {!For_every_MRR_product.Quantity} * {!For_every_MRR_product.Default_Price_ARR__c},
{!For_every_MRR_product.Quantity} * {!For_every_MRR_product.Sales_Price_ARR__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Contains Total Default Price / Sales Price per line item, not per unit.</description>
        <name>cur_a_TotalDefaultPricePerOneOffLineItem</name>
        <dataType>Currency</dataType>
        <expression>IF({!For_every_One_Off_product.Default_Price_ARR__c} &lt;&gt; 0, {!For_every_One_Off_product.Quantity} * {!For_every_One_Off_product.Default_Price_ARR__c},
{!For_every_One_Off_product.Quantity} * {!For_every_One_Off_product.Sales_Price_ARR__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Discount branch. Indicates new Sales price for each MRR product after discount/increase has been applied.</description>
        <name>cur_p_NewSalesPriceARRProducts</name>
        <dataType>Currency</dataType>
        <expression> IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_OLI_MRR.Default_Price_ARR__c} &lt;&gt; 0),
	{!Loop_OLI_MRR.Default_Price_ARR__c}  * (100 - {!ARR_Discount_Selected}) / 100,
	IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_OLI_MRR.Default_Price_ARR__c} = 0),
		{!Loop_OLI_MRR.Sales_Price_ARR__c}  * (100 - {!ARR_Discount_Selected}) / 100,
		IF(AND({!txt_p_ChoiceType} = &quot;Increase&quot;, {!Loop_OLI_MRR.Default_Price_ARR__c} &lt;&gt; 0),
			{!Loop_OLI_MRR.Default_Price_ARR__c} * (100 + {!By_what_do_you_want_to_increase_the_price}) / 100, 
			{!Loop_OLI_MRR.Sales_Price_ARR__c} * (100 + {!By_what_do_you_want_to_increase_the_price}) / 100)))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Contains Total Default Price / Sales Price per line item, not per unit.</description>
        <name>cur_p_TotalARRDefaultPricePerLineItem</name>
        <dataType>Currency</dataType>
        <expression>IF({!For_every_MRR_product_percentage.Default_Price_ARR__c} &lt;&gt; 0,
{!For_every_MRR_product_percentage.Quantity} * {!For_every_MRR_product_percentage.Default_Price_ARR__c},
{!For_every_MRR_product_percentage.Quantity} * {!For_every_MRR_product_percentage.Sales_Price_ARR__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Indicates Total Default Price (Default Price * Quantity) for each One-off/MRR product in the percentage-based branch when price change of all products is selected.</description>
        <name>cur_p_TotalDefaultPricePerARRAllLineItem</name>
        <dataType>Currency</dataType>
        <expression> IF({!For_each_of_all_OLI.Default_Price_ARR__c} &lt;&gt;0, {!For_each_of_all_OLI.Quantity} * {!For_each_of_all_OLI.Default_Price_ARR__c}, {!For_each_of_all_OLI.Quantity} * {!For_each_of_all_OLI.Sales_Price_ARR__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Indicates Total Default Price (Default Price * Quantity) for each One-off product in the percentage-based branch when only change of One-off products&apos; price is selected.</description>
        <name>cur_p_TotalDefaultPricePerOneOffLineItem</name>
        <dataType>Currency</dataType>
        <expression>IF({!One_off_to_assign_sum_of_default_price.Default_Price_ARR__c} &lt;&gt; 0,
{!One_off_to_assign_sum_of_default_price.Default_Price_ARR__c}  * {!One_off_to_assign_sum_of_default_price.Quantity},
{!One_off_to_assign_sum_of_default_price.Sales_Price_ARR__c}  * {!One_off_to_assign_sum_of_default_price.Quantity})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Amount branch. Returns % by which Total Default Price of MRR products is different from entered New Sales Price. Used in other formulas.</description>
        <name>num_a_MRRPriceChangeAmountToPercentage</name>
        <dataType>Number</dataType>
        <expression>(({!rec_CurrentOpportunity.ARR_manual__c} - {!New_ARR_Price}) * 100 / {!rec_CurrentOpportunity.ARR_manual__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Returns the difference between New ARR and Default ARR.</description>
        <name>num_a_NewARRMinusOldMRR</name>
        <dataType>Number</dataType>
        <expression>{!New_ARR_Price} - {!cur_DefaultPriceAllARRProducts}</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>New One-Off - Old One-Off</description>
        <name>num_a_NewOneOffMinusOldOneOff</name>
        <dataType>Number</dataType>
        <expression>{!New_One_Off_Price} - {!cur_DefaultPriceAllOneOffProducts}</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Amount branch. Indicates new Sales Price of each MRR product calculated based on Default Price and price change amount converted to percentage. Used in the loop that assigns Sales Price to all MRR products.</description>
        <name>num_a_NewSalesPriceMRRProduct</name>
        <dataType>Number</dataType>
        <expression>/* If Default Price of a product is zero, then the formula will use current Sales Price to accommodate the required price change, otherwise new Sales Price is calculated against Default Price*/

{!Update_Sales_Price_for_MRR_products.Sales_Price_ARR__c} * (100 - {!num_a_MRRPriceChangeAmountToPercentage}) / 100</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Amount branch. Indicates new Sales Price of each One-Off product calculated based on Default Price and price change amount converted to percentage. Used in the loop that assigns Sales Price to all One-Off products.</description>
        <name>num_a_NewSalesPriceOneOffProduct</name>
        <dataType>Number</dataType>
        <expression>{!Update_Sales_Price_for_One_off_products.Sales_Price_ARR__c} * (100 - {!num_a_OneOffPriceChangeAmountToPercentage}) / 100</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Returns Sales Price of each selected ARR product that accommodates the new ARR entered by the user.</description>
        <name>num_a_NewSalesPriceSelectedARRProducts</name>
        <dataType>Number</dataType>
        <expression>/* Indicates the difference between current MRR and selected MRR (ARR). After that, calculates % that the difference has from Total Sales price of selected products. After that, multiplies Sales Price of each product in the loop by the %*/

{!Apply_price_change.Sales_Price_ARR__c} * (1 - (({!rec_CurrentOpportunity.ARR_manual__c} - {!New_ARR_Price}) / {!cur_TotalSalesPriceSelectedProducts}))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Returns Sales Price of each selected One-Off product that accommodates the new One-Off value entered by the user.</description>
        <name>num_a_NewSalesPriceSelectedOneOffProducts</name>
        <dataType>Number</dataType>
        <expression>/* Indicates the difference between current One-Off of opportunity and selected One-off. After that, calculates % that the difference has from Total Sales price of selected products. After that, multiplies Sales Price of each product in the loop by the %*/

{!Apply_OneOff_Price_Change.Sales_Price_ARR__c} * (1 - (({!rec_CurrentOpportunity.One_off_from_Products__c} - {!New_One_Off_Price}) / {!cur_TotalSalesPriceSelectedProducts}))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Amount branch. Returns % by which Total Default Price of One Off products is different from entered New Sales Price. Used in other formulas.</description>
        <name>num_a_OneOffPriceChangeAmountToPercentage</name>
        <dataType>Number</dataType>
        <expression>(({!rec_CurrentOpportunity.One_off_from_Products__c} - {!New_One_Off_Price}) * 100 / {!rec_CurrentOpportunity.One_off_from_Products__c})</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Counts how many products were selected.</description>
        <name>num_both_CounterRawProducts</name>
        <dataType>Number</dataType>
        <expression>LEN({!txt_RawSelectedProducts})/20</expression>
        <scale>0</scale>
    </formulas>
    <formulas>
        <description>Discount branch. Indicates new Sales Price for each product after discount/increase has been applied.</description>
        <name>num_p_NewSalesPriceAllProducts</name>
        <dataType>Number</dataType>
        <expression>IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_All_OLI.Default_Price_ARR__c} &lt;&gt; 0),
{!Loop_All_OLI.Default_Price_ARR__c} * (100 - {!ALL_Discount_Selected}) / 100, 
IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_All_OLI.Default_Price_ARR__c} = 0),
{!Loop_All_OLI.Sales_Price_ARR__c} * (100 - {!ALL_Discount_Selected}) / 100, 
IF(AND({!txt_p_ChoiceType} = &quot;Increase&quot;, {!Loop_All_OLI.Default_Price_ARR__c} &lt;&gt; 0),
{!Loop_All_OLI.Default_Price_ARR__c}  * (100 + {!Percentage_Increase_All_Discount}) / 100, 
{!Loop_All_OLI.Sales_Price_ARR__c}  * (100 + {!Percentage_Increase_All_Discount}) / 100)))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Discount branch. Indicates new Sales Price of each One-Off product after increase/discount has been applied.</description>
        <name>num_p_NewSalesPriceOneoffProducts</name>
        <dataType>Number</dataType>
        <expression>IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_OLI_OneOff.Default_Price_ARR__c} &lt;&gt; 0),
{!Loop_OLI_OneOff.Default_Price_ARR__c} * (100 - {!OneOff_Discount_Selected}) / 100,
IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!Loop_OLI_OneOff.Default_Price__c} = 0),
{!Loop_OLI_OneOff.Sales_Price_ARR__c} * (100 - {!OneOff_Discount_Selected}) / 100,
IF(AND({!txt_p_ChoiceType} = &quot;Increase&quot;, {!Loop_OLI_OneOff.Default_Price_ARR__c} &lt;&gt; 0),
{!Loop_OLI_OneOff.Default_Price_ARR__c} * (100 + {!Percentage_OneOff_Increase_Discount}) / 100,
{!Loop_OLI_OneOff.Sales_Price_ARR__c} * (100 + {!Percentage_OneOff_Increase_Discount}) / 100)))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Discount branch. Indicates new Sales price of each selected product after discount/increase has been applied.</description>
        <name>num_p_NewSalesPriceSelectedProducts</name>
        <dataType>Number</dataType>
        <expression>IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!For_each_selected_OLI_percentage.Default_Price_ARR__c} &lt;&gt;0),
{!For_each_selected_OLI_percentage.Default_Price_ARR__c} * (100 - {!Indicate_discount}) / 100,
IF(AND({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!For_each_selected_OLI_percentage.Default_Price_ARR__c} = 0),
{!For_each_selected_OLI_percentage.Sales_Price_ARR__c} * (100 - {!Indicate_discount}) / 100,
IF(AND({!txt_p_ChoiceType} = &quot;Increase&quot;, {!For_each_selected_OLI_percentage.Default_Price_ARR__c} &lt;&gt; 0),
{!For_each_selected_OLI_percentage.Default_Price_ARR__c} * (100 + {!Indicate_increase}) / 100,
{!For_each_selected_OLI_percentage.Sales_Price_ARR__c} * (100 + {!Indicate_increase}) / 100)))</expression>
        <scale>8</scale>
    </formulas>
    <formulas>
        <description>Used in the percentage branch for screens only. Shows value entered by the user: by which % they want to change the price.</description>
        <name>num_p_PriceChangePercentageOfSelectedProducts</name>
        <dataType>Number</dataType>
        <expression>IF(ISBLANK({!Indicate_increase}), {!Indicate_discount}, {!Indicate_increase})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used in screen with user input to indicate new price after price increase/price decrease was applied for ARR products only.</description>
        <name>num_p_scr_ARRAfterDiscountApplied</name>
        <dataType>Number</dataType>
        <expression>IF({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!cur_DefaultPriceAllARRProducts} * (100 - {!ARR_Discount_Selected}) / 100,
IF({!txt_p_ChoiceType} = &quot;Increase&quot;, {!cur_DefaultPriceAllARRProducts} *(100 + {!By_what_do_you_want_to_increase_the_price}) / 100, 0))</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used on the screens with user input to show new MRR for products after discount is applied.</description>
        <name>num_p_scr_NewARRAllLineItems</name>
        <dataType>Number</dataType>
        <expression>IF({!txt_p_ChoiceType} = &quot;Increase&quot;, {!cur_DefaultPriceAllARRProducts} * (100 + {!Percentage_Increase_All_Discount}) / 100,
{!cur_DefaultPriceAllARRProducts} * (100 - {!ALL_Discount_Selected}) / 100)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used on the screen with user input to indicate what will be new One-off after discount/price increase % is applied.</description>
        <name>num_p_scr_NewOneOffAllLineItems</name>
        <dataType>Number</dataType>
        <expression>IF({!txt_p_ChoiceType} = &quot;Increase&quot;, {!cur_DefaultPriceAllOneOffProducts} * (100 +{!Percentage_Increase_All_Discount}) / 100, {!cur_DefaultPriceAllOneOffProducts} * (100 - {!ALL_Discount_Selected}) / 100)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used in screens with user inputs to indicate new total contract value after % price change was applied.</description>
        <name>num_p_scr_NewTotalContractValue</name>
        <dataType>Number</dataType>
        <expression>IF({!txt_p_ChoiceType} = &quot;Decrease&quot;,
(({!cur_DefaultPriceAllOneOffProducts} + {!cur_DefaultPriceAllARRProducts}) * (100 - {!ALL_Discount_Selected}) / 100),
(({!cur_DefaultPriceAllOneOffProducts} + {!cur_DefaultPriceAllARRProducts}) * (100 + {!Percentage_Increase_All_Discount}) / 100) 
)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Shows new One-off on the screens after % price change is applied.</description>
        <name>num_p_scr_OneOffAfterDiscountApplied</name>
        <dataType>Number</dataType>
        <expression>IF({!txt_p_ChoiceType} = &quot;Decrease&quot;, {!cur_DefaultPriceAllOneOffProducts} * (100 - {!OneOff_Discount_Selected}) / 100,
{!cur_DefaultPriceAllOneOffProducts} * (100 + {!Percentage_OneOff_Increase_Discount}) / 100)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used in screens to indicate current default MRR price from MRR products only.</description>
        <name>num_p_scr_TotalDefaultPriceMRR</name>
        <dataType>Number</dataType>
        <expression>ROUND({!cur_DefaultPriceAllARRProducts}, 2)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Used in the screen with user input to show the current default One-off from products.</description>
        <name>num_p_scr_TotalDefaultPriceOneOff</name>
        <dataType>Number</dataType>
        <expression>ROUND({!cur_DefaultPriceAllOneOffProducts}, 2)</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Percentage-based branch. Indicates current total Default contract value for the screen.</description>
        <name>num_p_scr_TotalDefaultValue</name>
        <dataType>Number</dataType>
        <expression>{!cur_DefaultPriceAllOneOffProducts} + {!cur_DefaultPriceAllARRProducts}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <description>Indicates either percentage increase or decrease based on the actual percentage. Used for the price change confirmation screen only.</description>
        <name>txt_a_DiscountAmountToPercentageMRR</name>
        <dataType>String</dataType>
        <expression>IF({!num_a_MRRPriceChangeAmountToPercentage} &gt; 0, &quot;will be decreased by &quot; &amp; TEXT(ROUND({!num_a_MRRPriceChangeAmountToPercentage}, 2)) &amp; &quot;%&quot;,
&quot;will be increased by &quot; &amp; TEXT(ROUND(ABS({!num_a_MRRPriceChangeAmountToPercentage}), 2)) &amp; &quot;%&quot;)</expression>
    </formulas>
    <formulas>
        <description>Amount branch. Used for the One-off screen to indicate by what % the price will be changed. For user experience.</description>
        <name>txt_a_DiscountAmountToPercentageOneOff</name>
        <dataType>String</dataType>
        <expression>IF({!num_a_OneOffPriceChangeAmountToPercentage} &gt; 0, &quot;will be decreased by &quot; &amp; TEXT(ROUND({!num_a_OneOffPriceChangeAmountToPercentage}, 2)) &amp; &quot;%&quot;,
&quot;will be increased by &quot; &amp; TEXT(ROUND(ABS({!num_a_OneOffPriceChangeAmountToPercentage}), 2)) &amp; &quot;%&quot;)</expression>
    </formulas>
    <formulas>
        <description>Amount branch. Removes the first product ID from the string of selected MRR products after the product was added to a usable collection.</description>
        <name>txt_a_RemoveFirstOLIFromSelectedMRRProducts</name>
        <dataType>String</dataType>
        <expression>TRIM(
SUBSTITUTE(
{!str_both_SelectedRawProducts}, {!txt_both_FirstSelectedProductID}, &quot;&quot;)
)</expression>
    </formulas>
    <formulas>
        <description>Used in both branches. Returns text ID of the first selected product. Used in applying Price Change to selected products.</description>
        <name>txt_both_FirstSelectedProductID</name>
        <dataType>String</dataType>
        <expression>LEFT({!str_both_SelectedRawProducts}, 18)</expression>
    </formulas>
    <formulas>
        <description>Trimmed raw products variable. Has only 18-digit IDs without any spaces between.</description>
        <name>txt_both_RawProductsCleaned</name>
        <dataType>String</dataType>
        <expression>TRIM(
SUBSTITUTE(
SUBSTITUTE(
SUBSTITUTE({!txt_RawSelectedProducts},
&quot;[&quot;, &quot;&quot;),
&quot;]&quot;, &quot;&quot;),
&quot;; &quot;, &apos;&apos;)
)</expression>
    </formulas>
    <formulas>
        <description>Percentage branch. Used in a loop for assigning discount to all products. If the product is not for renewal, then returns &quot;No&quot;; otherwise returns what the user entered at a previous stage.</description>
        <name>txt_p_RecurringDiscount</name>
        <dataType>String</dataType>
        <expression>IF({!Loop_All_OLI.For_Renewal__c} = True, {!Is_it_recurring_discount_All}, &quot;No&quot;)</expression>
    </formulas>
    <formulas>
        <description>Indicates average discount on One-off products. Used on the screens with user input.</description>
        <name>txt_p_scr_AverageOneOffDiscount</name>
        <dataType>String</dataType>
        <expression>IF({!rec_CurrentOpportunity.One_off_from_Products__c} * 100 / {!cur_DefaultPriceAllOneOffProducts} &lt; 100, &quot;Your average One-off discount is &quot;&amp; TEXT({!rec_CurrentOpportunity.One_off_from_Products__c} * 100 / {!cur_DefaultPriceAllOneOffProducts}), &quot;Your average One-off increase is &quot; &amp; TEXT({!rec_CurrentOpportunity.One_off_from_Products__c} * 100 / {!cur_DefaultPriceAllOneOffProducts} - 100))</expression>
    </formulas>
    <formulas>
        <description>Currency Sign of the opportunity. Used on the screens with user input.</description>
        <name>txt_p_scr_CurrencySign</name>
        <dataType>String</dataType>
        <expression>CASE({!rec_CurrentOpportunity.Currency_Text__c},
&quot;EUR&quot;, &quot;€&quot;,
&quot;USD&quot;, &quot;$&quot;,
&quot;GBP&quot;,  &quot;£&quot;,
{!rec_CurrentOpportunity.Currency_Text__c})</expression>
    </formulas>
    <formulas>
        <description>Returns the current ARR discount from the Default Price.</description>
        <name>txt_p_scr_CurrentARRDiscount</name>
        <dataType>String</dataType>
        <expression>IF(({!rec_CurrentOpportunity.ARR_manual__c} * 100 / {!cur_DefaultPriceAllARRProducts}) &lt;= 100, &quot;Your average ARR discount is &quot;&amp; TEXT(100 - ROUND({!rec_CurrentOpportunity.ARR_manual__c} * 100 / {!cur_DefaultPriceAllARRProducts}, 2)), &quot;Your average ARR increase is &quot;&amp; TEXT(ROUND(({!rec_CurrentOpportunity.ARR_manual__c} * 100 / {!cur_DefaultPriceAllARRProducts}) - 100, 2)))</expression>
    </formulas>
    <interviewLabel>Apply Price Change {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Apply Price Change</label>
    <loops>
        <description>Loops over each One-off product to apply the discount/increase the price by changing the Sales Price.</description>
        <name>Apply_Discount_to_One_Off_products</name>
        <label>Apply Price Change to One-Off products</label>
        <locationX>5008</locationX>
        <locationY>1243</locationY>
        <assignNextValueToReference>Loop_OLI_OneOff</assignNextValueToReference>
        <collectionReference>rec_col_OneOffOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_new_One_Off_Sales_Price</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Apply_OneOff_Price_Change</name>
        <label>Apply Price Change</label>
        <locationX>200</locationX>
        <locationY>1487</locationY>
        <collectionReference>rec_col_OpportunityLineItemsForSelectedLogic</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_Sales_price_positive_OneOff</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_all_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Applies price change to each product.</description>
        <name>Apply_price_change</name>
        <label>Apply price change</label>
        <locationX>226</locationX>
        <locationY>423</locationY>
        <collectionReference>rec_col_OpportunityLineItemsForSelectedLogic</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_Sales_price_positive_MRR</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_all_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each product and applies price change % by updating the Sales Price.</description>
        <name>Apply_Price_Change_to_All_products</name>
        <label>Apply Price Change to All products</label>
        <locationX>5093</locationX>
        <locationY>1636</locationY>
        <assignNextValueToReference>Loop_All_OLI</assignNextValueToReference>
        <collectionReference>rec_col_AllOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Update_Sales_Price_of_each_OLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop over each MRR product and change its Sales Price to apply discount/increase %.</description>
        <name>Apply_Price_Change_to_MRR_products</name>
        <label>Apply Price Change to MRR products</label>
        <locationX>5281</locationX>
        <locationY>615</locationY>
        <assignNextValueToReference>Loop_OLI_MRR</assignNextValueToReference>
        <collectionReference>rec_col_MRROpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_new_MRR_Sales_Price</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each OLI and adds quantity and Default Price of each to corresponding variable that will be used further in calculating the discount proportion.</description>
        <name>Calculate_Discount_Proportion</name>
        <label>Calculate Discount Proportion</label>
        <locationX>407</locationX>
        <locationY>422</locationY>
        <collectionReference>rec_col_OpportunityLineItemsForSelectedLogic</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Store_Sales_Price_and_Quantity_of_OLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Apply_price_change</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops through each item in the newly created collection of text elements.</description>
        <name>For_each_element_in_the_ID_text_collection</name>
        <label>For each element in the ID text collection</label>
        <locationX>813</locationX>
        <locationY>415</locationY>
        <collectionReference>txt_col_SelectedProductsID</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_OLI_record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Confirm_Number_of_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops through each item in the newly created collection of text elements.</description>
        <name>For_each_element_in_the_OneOff_D_text_collection</name>
        <label>For each element in the ID text collection</label>
        <locationX>825</locationX>
        <locationY>1467</locationY>
        <collectionReference>txt_col_SelectedProductsID</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_OLI_OneOff</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Confirm_Number_of_Products_OneOff</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over all selected products and adds price to the variable.</description>
        <name>For_each_of_all_OLI</name>
        <label>For each of all OLI</label>
        <locationX>4385</locationX>
        <locationY>1640</locationY>
        <collectionReference>rec_col_AllOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>OLI_type</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Select_discount_all</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over the list of selected Opportunity Line Items to change the Sales Price.</description>
        <name>For_each_selected_OLI_percentage</name>
        <label>For each selected OLI</label>
        <locationX>5409</locationX>
        <locationY>818</locationY>
        <collectionReference>rec_col_OpportunityLineItemsForSelectedLogic</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Update_Sales_Price_selected_percentage</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each element of the text collection to find OLI that has the same ID.</description>
        <name>For_every_element_from_the_text_collection</name>
        <label>For every element from the text collection</label>
        <locationX>5076</locationX>
        <locationY>816</locationY>
        <collectionReference>txt_col_SelectedProductsID</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_OLI_Record_All</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Confirm_Number_of_Products_0</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop in the amount-based branch that assigns total default price of all MRR products to one variable. Used instead of a roll-up summary field on opportunity.</description>
        <name>For_every_MRR_product</name>
        <label>For every MRR product</label>
        <locationX>2772</locationX>
        <locationY>816</locationY>
        <collectionReference>rec_col_MRROpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Default_Price_per_MRR_to_the_variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Get_One_off_products_for_Amount_branch</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over every discount product to calculate the total default price.</description>
        <name>For_every_MRR_product_percentage</name>
        <label>For every MRR product</label>
        <locationX>4454</locationX>
        <locationY>617</locationY>
        <collectionReference>rec_col_MRROpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Default_Price_per_product_to_Total_Default_Price_variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Select_ARR_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loop in the amount-based branch that assigns total default price of all One-Off products in one variable. Used instead of a roll-up summary field on opportunity.</description>
        <name>For_every_One_Off_product</name>
        <label>For every One-Off product</label>
        <locationX>2508</locationX>
        <locationY>816</locationY>
        <collectionReference>rec_col_OneOffOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Default_Price_per_One_off_to_the_variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Choose_discount_amount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each One-off OLI to sum up the default price.</description>
        <name>One_off_to_assign_sum_of_default_price</name>
        <label>One-off to assign sum of default price</label>
        <locationX>4442</locationX>
        <locationY>1231</locationY>
        <collectionReference>rec_col_OneOffOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Default_Price</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Select_OneOff_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each OLI and adds quantity and Default Price of each to corresponding variable that will be used further in calculating the discount proportion.</description>
        <name>To_calculate_Discount_Proportion_One_off</name>
        <label>Calculate Discount Proportion</label>
        <locationX>409</locationX>
        <locationY>1476</locationY>
        <collectionReference>rec_col_OpportunityLineItemsForSelectedLogic</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Store_Sales_Price_and_Quantity_of_OneOff_OLI</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Apply_OneOff_Price_Change</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Updates Sales Price for each MRR product to accommodate the new MRR (ARR) for opportunity. Used in the amount branch.</description>
        <name>Update_Sales_Price_for_MRR_products</name>
        <label>Update Sales Price for MRR products</label>
        <locationX>1161</locationX>
        <locationY>837</locationY>
        <collectionReference>rec_col_MRROpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Sales_Price_great_than_0_MRR</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_all_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <description>Loops over each of all One-off products and updates Sales Price to accommodate selected price change.</description>
        <name>Update_Sales_Price_for_One_off_products</name>
        <label>Update Sales Price for One-off products</label>
        <locationX>1159</locationX>
        <locationY>993</locationY>
        <collectionReference>rec_col_OneOffOpportunityLineItems</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Sales_Price_greater_than_0_OneOff</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_all_OLI_records_to_add_discount</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordLookups>
        <description>Gets all OLIs from the opportunity.</description>
        <name>Get_All_Opportunity_Line_Items</name>
        <label>Get All Opportunity Line Items</label>
        <locationX>4128</locationX>
        <locationY>1633</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>For_each_of_all_OLI</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>rec_col_AllOpportunityLineItems</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>UnitPrice</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>Discount</queriedFields>
        <queriedFields>Recurring_Discount__c</queriedFields>
        <queriedFields>For_Renewal__c</queriedFields>
        <queriedFields>Default_Price__c</queriedFields>
        <queriedFields>Default_Price_Discount__c</queriedFields>
        <queriedFields>Discount_percentage__c</queriedFields>
        <queriedFields>Description</queriedFields>
        <queriedFields>Default_Price_ARR__c</queriedFields>
        <queriedFields>Sales_Price_ARR__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets all MRR products from the opportunity.</description>
        <name>Get_MRR_line_items</name>
        <label>Get MRR line items</label>
        <locationX>4279</locationX>
        <locationY>616</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>For_every_MRR_product_percentage</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>rec_col_MRROpportunityLineItems</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>UnitPrice</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>Discount</queriedFields>
        <queriedFields>Recurring_Discount__c</queriedFields>
        <queriedFields>Default_Price__c</queriedFields>
        <queriedFields>Default_Price_Discount__c</queriedFields>
        <queriedFields>Discount_percentage__c</queriedFields>
        <queriedFields>Description</queriedFields>
        <queriedFields>Sales_Price_ARR__c</queriedFields>
        <queriedFields>Default_Price_ARR__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets all MRR products from the opportunity in the amount-based branch.</description>
        <name>Get_MRR_products_for_Amount_branch</name>
        <label>Get MRR products for Amount branch</label>
        <locationX>2925</locationX>
        <locationY>816</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>For_every_MRR_product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>rec_col_MRROpportunityLineItems</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>UnitPrice</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>Discount</queriedFields>
        <queriedFields>Recurring_Discount__c</queriedFields>
        <queriedFields>For_Renewal__c</queriedFields>
        <queriedFields>Default_Price__c</queriedFields>
        <queriedFields>Default_Price_Discount__c</queriedFields>
        <queriedFields>Description</queriedFields>
        <queriedFields>Sales_Price_ARR__c</queriedFields>
        <queriedFields>Default_Price_ARR__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>Get_OLI_OneOff</name>
        <label>Get OLI Record</label>
        <locationX>852</locationX>
        <locationY>1668</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_to_a_new_OneOff_OLI_collection</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>For_each_element_in_the_OneOff_D_text_collection</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Finds a corresponding OLI record that has the same ID as the text element&apos;s value.</description>
        <name>Get_OLI_record</name>
        <label>Get OLI record</label>
        <locationX>816</locationX>
        <locationY>212</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_to_a_new_MRR_OLI_collection</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>For_each_element_in_the_ID_text_collection</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Find OLI record with the same ID as the current element.</description>
        <name>Get_OLI_Record_All</name>
        <label>Get OLI Record</label>
        <locationX>5029</locationX>
        <locationY>1003</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_to_a_new_Opportunity_Product_collection_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>For_every_element_from_the_text_collection</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_One_Off_product</name>
        <label>Get One-Off product</label>
        <locationX>4296</locationX>
        <locationY>1234</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>One_off_to_assign_sum_of_default_price</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>rec_col_OneOffOpportunityLineItems</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>UnitPrice</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>Discount</queriedFields>
        <queriedFields>Recurring_Discount__c</queriedFields>
        <queriedFields>Default_Price__c</queriedFields>
        <queriedFields>Default_Price_Discount__c</queriedFields>
        <queriedFields>Discount_percentage__c</queriedFields>
        <queriedFields>Description</queriedFields>
        <queriedFields>Sales_Price_ARR__c</queriedFields>
        <queriedFields>Default_Price_ARR__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets all One-Off products from the opportunity in the amount-based branch.</description>
        <name>Get_One_off_products_for_Amount_branch</name>
        <label>Get One-off products for Amount branch</label>
        <locationX>2630</locationX>
        <locationY>820</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>For_every_One_Off_product</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <filters>
            <field>For_Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>OpportunityLineItem</object>
        <outputReference>rec_col_OneOffOpportunityLineItems</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>UnitPrice</queriedFields>
        <queriedFields>Quantity</queriedFields>
        <queriedFields>Discount</queriedFields>
        <queriedFields>Recurring_Discount__c</queriedFields>
        <queriedFields>For_Renewal__c</queriedFields>
        <queriedFields>Default_Price__c</queriedFields>
        <queriedFields>Default_Price_Discount__c</queriedFields>
        <queriedFields>Description</queriedFields>
        <queriedFields>Sales_Price_ARR__c</queriedFields>
        <queriedFields>Default_Price_ARR__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Collects main information about the opportunity in the amount-based branch.</description>
        <name>get_Opportunity_for_amount_branch</name>
        <label>Get Opportunity for Amount Branch</label>
        <locationX>3089</locationX>
        <locationY>816</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Get_MRR_products_for_Amount_branch</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputReference>rec_CurrentOpportunity</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>MRR_from_Products__c</queriedFields>
        <queriedFields>One_off_from_Products__c</queriedFields>
        <queriedFields>Total_Contract_Value__c</queriedFields>
        <queriedFields>Currency_Text__c</queriedFields>
        <queriedFields>CurrencyIsoCode</queriedFields>
        <queriedFields>Netsuite_Term__c</queriedFields>
        <queriedFields>Discount_Amount__c</queriedFields>
        <queriedFields>Discount_Amount_One_off__c</queriedFields>
        <queriedFields>of_products_MRR__c</queriedFields>
        <queriedFields>List_Price_MRR__c</queriedFields>
        <queriedFields>ARR_manual__c</queriedFields>
    </recordLookups>
    <recordLookups>
        <description>Gets information about the opportunity that the user is working with. Used in the percentage-based branch.</description>
        <name>get_Opportunity_Percentage_Branch</name>
        <label>Get Opportunity for Percentage Branch</label>
        <locationX>3562</locationX>
        <locationY>818</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Which_price_change_type_selected</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>curOpportunity</elementReference>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputReference>rec_CurrentOpportunity</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>MRR_from_Products__c</queriedFields>
        <queriedFields>One_off_from_Products__c</queriedFields>
        <queriedFields>Total_Contract_Value__c</queriedFields>
        <queriedFields>Currency_Text__c</queriedFields>
        <queriedFields>CurrencyIsoCode</queriedFields>
        <queriedFields>Netsuite_Term__c</queriedFields>
        <queriedFields>Discount_Amount__c</queriedFields>
        <queriedFields>Discount_Amount_One_off__c</queriedFields>
        <queriedFields>ARR_manual__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <description>Updates all Opportunity Line Items with a new Sales Price.</description>
        <name>Update_all_OLI_records_to_add_discount</name>
        <label>Update all OLI records to add discount</label>
        <locationX>194</locationX>
        <locationY>933</locationY>
        <faultConnector>
            <targetReference>Opportunity_error_screen_0</targetReference>
        </faultConnector>
        <inputReference>rec_col_OLIToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Updates all selected OLIs to apply new Sales Price.</description>
        <name>Update_OLI_records_to_add_discount</name>
        <label>Update OLI records to add discount</label>
        <locationX>5793</locationX>
        <locationY>1132</locationY>
        <faultConnector>
            <targetReference>Opportunity_error_screen_0</targetReference>
        </faultConnector>
        <inputReference>rec_col_OLIToUpdate</inputReference>
    </recordUpdates>
    <recordUpdates>
        <description>Update Discount Reason on Opportunity</description>
        <name>Update_Opportunity_A_MRR</name>
        <label>Update Opportunity</label>
        <locationX>1793</locationX>
        <locationY>709</locationY>
        <connector>
            <targetReference>Type_of_MRR_discount_decision</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Opportunity_error_screen</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>rec_CurrentOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Discount_reasons__c</field>
            <value>
                <elementReference>Discount_Reason_A_MRR</elementReference>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update Discount Reason on Opportunity</description>
        <name>Update_Opportunity_A_OneOff</name>
        <label>Update Opportunity</label>
        <locationX>1795</locationX>
        <locationY>1069</locationY>
        <connector>
            <targetReference>Type_of_One_off_discount_selected</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Opportunity_error_screen</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>rec_CurrentOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Discount_reasons__c</field>
            <value>
                <elementReference>Discount_Reason_A_OneOff</elementReference>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <recordUpdates>
        <description>Update Discount Reasons on Opportunity</description>
        <name>Update_Opportunity_Percentage_Branch</name>
        <label>Update Opportunity - Percentage Branch</label>
        <locationX>4113</locationX>
        <locationY>891</locationY>
        <connector>
            <targetReference>Kind_of_discount_selected</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Opportunity_error_screen</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>rec_CurrentOpportunity.Id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>Discount_reasons__c</field>
            <value>
                <elementReference>Discount_Reason_P</elementReference>
            </value>
        </inputAssignments>
        <object>Opportunity</object>
    </recordUpdates>
    <screens>
        <description>Percentage-based branch. User input specifying to what products they want to add discount and whether it is an increase or decrease.</description>
        <name>Choose_Discount</name>
        <label>Choose Discount</label>
        <locationX>3428</locationX>
        <locationY>818</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>get_Opportunity_Percentage_Branch</targetReference>
        </connector>
        <fields>
            <name>introChooseDiscount</name>
            <fieldText>&lt;p&gt;Please select what kind of price change you want to apply:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Change price of all products;&lt;/li&gt;&lt;li&gt;Change price of one or several individual products;&lt;/li&gt;&lt;li&gt;Change price of ARR products only;&lt;/li&gt;&lt;li&gt;Change price of One-off products only.&lt;/li&gt;&lt;/ul&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Please_select_the_discount_type</name>
            <choiceReferences>All_products</choiceReferences>
            <choiceReferences>Individual_Products_Choice</choiceReferences>
            <choiceReferences>MRR_products_Choice</choiceReferences>
            <choiceReferences>One_off_products_Choice</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Please select how you want to apply the price change.</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <fields>
            <name>introPriceChangeType</name>
            <fieldText>&lt;p&gt;You can either increase the sales price of products by a certain % or decrease (apply discount). Please select below. &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Select_the_price_change_type</name>
            <choiceReferences>Increase_Choice</choiceReferences>
            <choiceReferences>Decrease_Choice</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Select the price change type.</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>User input: indicate on which products they want to change the price.</description>
        <name>Choose_discount_amount</name>
        <label>Choose discount - amount</label>
        <locationX>2304</locationX>
        <locationY>817</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Type_of_discount_decision</targetReference>
        </connector>
        <fields>
            <name>introChooseDiscountAmount</name>
            <fieldText>&lt;p&gt;Please select what kind of price change you want to apply:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;Change price of all ARR products;&lt;/li&gt;&lt;li&gt;Change price of all One-off products;&lt;/li&gt;&lt;li&gt;Change price of specific ARR products;&lt;/li&gt;&lt;li&gt;Change price of specific One-off products.&lt;/li&gt;&lt;/ul&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Please_select_the_discount_type_amount</name>
            <choiceReferences>MRR_products_Choice</choiceReferences>
            <choiceReferences>Specific_MRR_Products_Choice</choiceReferences>
            <choiceReferences>One_off_products_Choice</choiceReferences>
            <choiceReferences>Individual_OneOff_Choice</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Please select where you want to change the price:</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Choose_Discount_Reason_A_MRR</name>
        <label>Choose Discount Reason</label>
        <locationX>1922</locationX>
        <locationY>687</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Opportunity_A_MRR</targetReference>
        </connector>
        <fields>
            <name>Please_choose_Discount_Reason_A_MRR</name>
            <fieldText>&lt;p&gt;Please choose Discount Reason&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Discount_Reason_A_MRR</name>
            <choiceReferences>Discount_Reason_Choice_Set</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Discount Reason</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Choose_Discount_Reason_A_OneOff</name>
        <label>Choose Discount Reason</label>
        <locationX>1941</locationX>
        <locationY>1072</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Opportunity_A_OneOff</targetReference>
        </connector>
        <fields>
            <name>Please_choose_Discount_Reason_A_OneOff</name>
            <fieldText>&lt;p&gt;Please choose Discount Reason&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Discount_Reason_A_OneOff</name>
            <choiceReferences>Discount_Reason_Choice_Set</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Discount Reason</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Choose_Discount_Reason_P</name>
        <label>Choose Discount Reason</label>
        <locationX>3989</locationX>
        <locationY>891</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Opportunity_Percentage_Branch</targetReference>
        </connector>
        <fields>
            <name>Please_chose_Discount_Reason_Percentage_Branch</name>
            <fieldText>&lt;p&gt;Please chose Discount Reason&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Discount_Reason_P</name>
            <choiceReferences>Discount_Reason_Choice_Set</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Discount Reason</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>Users need to confirm new MRR/ARR of products. Visibility of elements is defined by previous choice of the user: whether it is an increase or decrease.</description>
        <name>Confirm_New_MRR_from_products</name>
        <label>Confirm New MRR from products</label>
        <locationX>4966</locationX>
        <locationY>622</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Apply_Price_Change_to_MRR_products</targetReference>
        </connector>
        <fields>
            <name>introNewMRRDecrease</name>
            <fieldText>&lt;p&gt;Your new discount is &lt;b&gt;{!ARR_Discount_Selected}&lt;/b&gt;%. With that discount, your new ARR from products will be &lt;b&gt;{!num_p_scr_ARRAfterDiscountApplied}{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;If you want to change the discount, click &quot;Previous&quot; and update the field. If you agree with this discount, click &quot;Next&quot; to apply it to all ARR products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>introNewMRRIncrease</name>
            <fieldText>&lt;p&gt;You will increase the price of ARR products by &lt;b&gt;{!By_what_do_you_want_to_increase_the_price}&lt;/b&gt;%. With that increase, your new ARR from products will be &lt;b&gt;{!num_p_scr_ARRAfterDiscountApplied}{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;If you want to change the percentage, click &quot;Previous&quot; and update the field. If you agree with this, click &quot;Next&quot; to apply it to all ARR products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Confirm_Number_of_Products</name>
        <label>Confirm Number of Products</label>
        <locationX>561</locationX>
        <locationY>423</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Calculate_Discount_Proportion</targetReference>
        </connector>
        <fields>
            <name>scr_DiscountConfirmationSelectedMRR</name>
            <fieldText>&lt;p&gt;The price will be changed for {!num_both_CounterRawProducts} ARR product(s).&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Confirm_Number_of_Products_0</name>
        <label>Confirm Number of Products</label>
        <locationX>5260</locationX>
        <locationY>817</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>For_each_selected_OLI_percentage</targetReference>
        </connector>
        <fields>
            <name>scr_txt_PercBranchNumOfProductsSelected</name>
            <fieldText>&lt;p&gt;The price change of &lt;b&gt;{!num_p_PriceChangePercentageOfSelectedProducts}%&lt;/b&gt; will be applied to {!num_both_CounterRawProducts} product(s).&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Confirm_Number_of_Products_OneOff</name>
        <label>Confirm Number of Products</label>
        <locationX>570</locationX>
        <locationY>1475</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>To_calculate_Discount_Proportion_One_off</targetReference>
        </connector>
        <fields>
            <name>txt_a_DiscountConfirmationSelectedOneOff</name>
            <fieldText>&lt;p&gt;The discount will be applied to {!num_both_CounterRawProducts} One-off product(s).&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Discount_Confirmation_Amount</name>
        <label>Discount Confirmation</label>
        <locationX>1553</locationX>
        <locationY>836</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Sales_Price_for_MRR_products</targetReference>
        </connector>
        <fields>
            <name>txt_a_DiscountConfirmationMRR</name>
            <fieldText>&lt;p&gt;The current price of all ARR products {!txt_a_DiscountAmountToPercentageMRR} to accommodate your sales price update.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Recurring_discount</name>
            <choiceReferences>Recurring_Discount_CS</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Recurring price change?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>DiscountConfirmationOneoff</name>
        <label>Discount Confirmation</label>
        <locationX>1568</locationX>
        <locationY>994</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Update_Sales_Price_for_One_off_products</targetReference>
        </connector>
        <fields>
            <name>txt_a_DiscountConfirmationOneOffs</name>
            <fieldText>&lt;p&gt;The current price of all One-off products {!txt_a_DiscountAmountToPercentageOneOff} to accommodate your new One-Off price.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Invalid_Discount</name>
        <label>Invalid Discount</label>
        <locationX>237</locationX>
        <locationY>46</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>introInvalidDiscount</name>
            <fieldText>&lt;p&gt;Your discount is invalid: the price of {!Apply_price_change.Name} is too small. Please click &quot;Finish&quot; and check your products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>New_OneOff_from_products</name>
        <label>New One-Off from products</label>
        <locationX>4817</locationX>
        <locationY>1242</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Apply_Discount_to_One_Off_products</targetReference>
        </connector>
        <fields>
            <name>introNewOneOff</name>
            <fieldText>&lt;p&gt;Your new discount is &lt;b&gt;{!OneOff_Discount_Selected}&lt;/b&gt;%. With that discount, your new One-Off from products will be &lt;b&gt;{!num_p_scr_OneOffAfterDiscountApplied}{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;If you want to change the discount, click &quot;Previous&quot; and update the field. If you agree with this discount, click &quot;Next&quot; to apply it to all One-off products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>introOneOffIncrease</name>
            <fieldText>&lt;p&gt;You will increase the product price of One-off products by &lt;b&gt;{!Percentage_OneOff_Increase_Discount}&lt;/b&gt;%. With that increase, your new One-Off from products will be &lt;b&gt;{!num_p_scr_OneOffAfterDiscountApplied}{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;If you want to change the percentage, click &quot;Previous&quot; and update the field. If you agree with this new price, click &quot;Next&quot; to apply it to all One-off products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>New_price_from_products_All</name>
        <label>New Total Contract Value</label>
        <locationX>4845</locationX>
        <locationY>1635</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Apply_Price_Change_to_All_products</targetReference>
        </connector>
        <fields>
            <name>introNewPrice</name>
            <fieldText>&lt;p&gt;Your new discount is &lt;b&gt;{!ALL_Discount_Selected}&lt;/b&gt;%. With that discount, your new Total Contract value will be &lt;b&gt;{!num_p_scr_NewTotalContractValue}{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;Your new ARR from products will be &lt;b&gt;{!num_p_scr_NewARRAllLineItems}&lt;/b&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!txt_p_scr_CurrencySign}&lt;/b&gt;, new One-off from products will be &lt;b&gt;{!num_p_scr_NewOneOffAllLineItems}&lt;/b&gt;&lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!txt_p_scr_CurrencySign}&lt;/b&gt;.&lt;/p&gt;&lt;p&gt;If you want to change the discount, click &quot;Previous&quot; and update the field. If you agree with this discount, click &quot;Next&quot; to apply it to all products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>introNewPriceIncreaseAll</name>
            <fieldText>&lt;p&gt;Your new price will be increased by &lt;b&gt;{!Percentage_Increase_All_Discount}&lt;/b&gt;%. With that increase your new Total Contract value will be &lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!num_p_scr_NewTotalContractValue}&lt;/b&gt;&lt;b&gt;{!txt_p_scr_CurrencySign}&lt;/b&gt;.&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;Your new ARR from products will be &lt;/span&gt;&lt;b style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;{!num_p_scr_NewARRAllLineItems}{!txt_p_scr_CurrencySign}&lt;/b&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;, new One-off from products will be &lt;/span&gt;&lt;b style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;{!num_p_scr_NewOneOffAllLineItems}{!txt_p_scr_CurrencySign}&lt;/b&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;.&lt;/span&gt;&lt;/p&gt;&lt;p&gt;If you want to change the price, click &quot;Previous&quot; and update the field. If you agree with this increase, click &quot;Next&quot; to apply it to all products.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Opportunity_error_screen</name>
        <label>Opportunity error screen</label>
        <locationX>3162</locationX>
        <locationY>1219</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Errormessage</name>
            <fieldText>&lt;p&gt;An error occurred while updating the opportunity.Please correct the issues and try again.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Error Message:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(218, 19, 19);&quot;&gt;{!$Flow.FaultMessage}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Opportunity_error_screen_0</name>
        <label>Opportunity product error screen</label>
        <locationX>2251</locationX>
        <locationY>1529</locationY>
        <allowBack>false</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>false</allowPause>
        <fields>
            <name>Errormessage_0</name>
            <fieldText>&lt;p&gt;An error occurred while updating the opportunity products.Please correct the issues and try again.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;Error Message:&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(218, 19, 19);&quot;&gt;{!$Flow.FaultMessage}&lt;/span&gt;&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>This is the first screen, where users can select what kind of discount they would like to apply: amount-based or percentage-based.</description>
        <name>scr_Introduction</name>
        <label>Introduction</label>
        <locationX>3263</locationX>
        <locationY>676</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>decision_Type_of_Discount</targetReference>
        </connector>
        <fields>
            <name>introStart</name>
            <fieldText>&lt;p&gt;This screen sequence will assist you with changing the sales price of opportunity products.&lt;/p&gt;&lt;p&gt;What kind of the price change do you want to apply? You can either select the percentage (e.g. apply 15% discount to all products) or enter your new sales price and let Salesforce split it among products.&lt;/p&gt;&lt;p&gt;Please select below.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>What_kind_of_price_change_do_you_want_to_apply</name>
            <choiceReferences>choicePercentageBased</choiceReferences>
            <choiceReferences>choiceAmounBased</choiceReferences>
            <dataType>String</dataType>
            <fieldText>What kind of price change do you want to apply?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>User selects discount/increase % and specified whether it is recurring or not. 
Increase and discount elements are visible depending on the prior choice.</description>
        <name>Select_ARR_discount</name>
        <label>Select ARR discount</label>
        <locationX>4771</locationX>
        <locationY>623</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Confirm_New_MRR_from_products</targetReference>
        </connector>
        <fields>
            <name>introSelectMRRDiscount</name>
            <fieldText>&lt;p&gt;You chose to {!txt_p_ChoiceType} the price of ARR products only.&lt;/p&gt;&lt;p&gt;Your current ARR from products is &lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!rec_CurrentOpportunity.ARR_manual__c}&lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt; &lt;/span&gt;&lt;b&gt;{!txt_p_scr_CurrencySign}. &lt;/b&gt;Your default ARR from products without any price changes is &lt;b&gt;{!num_p_scr_TotalDefaultPriceMRR} &lt;/b&gt;&lt;b style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;{!txt_p_scr_CurrencySign}&lt;/b&gt;.&lt;/p&gt;&lt;p&gt;{!txt_p_scr_CurrentARRDiscount} %.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;Please note that by entering % below you&apos;ll be applying changes to the default price, not the current ARR. It means that mentioned above discount or increase % will be overwritten with the one you enter below.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>ARR_Discount_Selected</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>What discount % do you want to apply?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Please enter the discount % between 0 and 100.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>{!ARR_Discount_Selected} &lt; 101 &amp;&amp; {!ARR_Discount_Selected} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>By_what_do_you_want_to_increase_the_price</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>By what % do you want to increase the price?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Please enter % between 0 and 100.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>{!By_what_do_you_want_to_increase_the_price} &lt; 101 &amp;&amp; {!By_what_do_you_want_to_increase_the_price} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Is_it_recurring_MRR_discount</name>
            <choiceReferences>Recurring_Discount_CS</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Is it recurring MRR discount?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_discount_all</name>
        <label>Select Discount</label>
        <locationX>4625</locationX>
        <locationY>1636</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>New_price_from_products_All</targetReference>
        </connector>
        <fields>
            <name>introSelectDiscountAllLineItems</name>
            <fieldText>&lt;p&gt;You chose to change price of all products.&lt;/p&gt;&lt;p&gt;The current Contract Value of this opportunity is &lt;b&gt;{!rec_CurrentOpportunity.Total_Contract_Value__c} {!txt_p_scr_CurrencySign}&lt;/b&gt;. Current default price of all products is &lt;b&gt;{!num_p_scr_TotalDefaultValue} &lt;/b&gt;&lt;b style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;{!txt_p_scr_CurrencySign}. &lt;/b&gt;&lt;/p&gt;&lt;p&gt;Below you can select by how many % you want to change the total default price, not the current contract value.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>ALL_Discount_Selected</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>What discount % do you want to apply to the default price?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;Please enter % discount between 0 and 100. &lt;/p&gt;</errorMessage>
                <formulaExpression>{!ALL_Discount_Selected} &lt; 101 &amp;&amp; {!ALL_Discount_Selected} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Percentage_Increase_All_Discount</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>By what % do you want to increase the default price?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;Please enter % value between 0 and 100. &lt;/p&gt;</errorMessage>
                <formulaExpression>{!Percentage_Increase_All_Discount} &lt; 101 &amp;&amp; {!Percentage_Increase_All_Discount} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Is_it_recurring_discount_All</name>
            <choiceReferences>Recurring_Discount_CS</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Is it recurring discount for MRR products?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <description>User input: indicates new MRR price of the opportunity.</description>
        <name>Select_New_Sales_Price</name>
        <label>Select New Sales Price</label>
        <locationX>2161</locationX>
        <locationY>613</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Increase_or_Decrease</targetReference>
        </connector>
        <fields>
            <name>introDiscountAmount</name>
            <fieldText>&lt;p&gt;Your current ARR is &lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!rec_CurrentOpportunity.ARR_manual__c} {!rec_CurrentOpportunity.Currency_Text__c}  &lt;/b&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;(How much a customer will pay). &lt;/span&gt;&lt;/p&gt;&lt;p&gt;For how much do you want to sell all ARR products? Note that you can both increase and decrease the ARR amount.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>New_ARR_Price</name>
            <dataType>Number</dataType>
            <fieldText>New ARR Price</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_New_Sales_Price_0</name>
        <label>Select New Sales Price</label>
        <locationX>2160</locationX>
        <locationY>1203</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Increase_or_Decrease_A_OneOff</targetReference>
        </connector>
        <fields>
            <name>txt_a_EnterDiscountAmountOneOff</name>
            <fieldText>&lt;p&gt;Current One-off from products on this opportunity is &lt;b style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;{!rec_CurrentOpportunity.One_off_from_Products__c} {!rec_CurrentOpportunity.Currency_Text__c}&lt;/b&gt;&lt;span style=&quot;color: rgb(62, 62, 60); background-color: rgb(255, 255, 255);&quot;&gt;. &lt;/span&gt;&lt;/p&gt;&lt;p&gt;For how much do you want to sell all One-off products? Note that you can both increase the One-off and decrease it (apply a discount).&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>New_One_Off_Price</name>
            <dataType>Number</dataType>
            <fieldText>New One-Off Price</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_OneOff_discount</name>
        <label>Select One-Off discount</label>
        <locationX>4650</locationX>
        <locationY>1241</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>New_OneOff_from_products</targetReference>
        </connector>
        <fields>
            <name>introSelectOneOffDiscount</name>
            <fieldText>&lt;p&gt;You chose to change the price of One-off products only.&lt;/p&gt;&lt;p&gt;Your current One-off from products is &lt;b&gt;{!rec_CurrentOpportunity.One_off_from_Products__c} {!txt_p_scr_CurrencySign}. &lt;/b&gt;Your current default One-off from products is &lt;b&gt;{!num_p_scr_TotalDefaultPriceOneOff}&lt;/b&gt; &lt;b style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;{!txt_p_scr_CurrencySign}. &lt;/b&gt;{!txt_p_scr_AverageOneOffDiscount}%.&lt;/p&gt;&lt;p&gt;Please note that by selecting % below you&apos;ll be applying changes to the default price, not the current One-off. It means that mentioned above discount or increase % will be overwritten with the one you enter below.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>OneOff_Discount_Selected</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>What discount % do you want to apply?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;Please enter discount % between 0 and 100.&lt;/p&gt;</errorMessage>
                <formulaExpression>{!OneOff_Discount_Selected} &lt; 101 &amp;&amp; {!OneOff_Discount_Selected} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Percentage_OneOff_Increase_Discount</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>By what % do you want to increase the standard price?</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>true</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Please enter % value between 0 and 100.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>{!Percentage_OneOff_Increase_Discount} &lt; 101 &amp;&amp; {!Percentage_OneOff_Increase_Discount} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_products_for_discount_Percentage</name>
        <label>Select products for discount</label>
        <locationX>4463</locationX>
        <locationY>815</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Selected_All_products_to_string</targetReference>
        </connector>
        <fields>
            <name>introProductsForPartialDiscountPercentage</name>
            <fieldText>&lt;p&gt;Please select below products that you would like to change the price for.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Products_Selected_Discount_percentage</name>
            <choiceReferences>set_p_AllLineItems</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Products</fieldText>
            <fieldType>MultiSelectPicklist</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Indicate_discount</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>Indicate discount %</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;&lt;span style=&quot;background-color: rgb(255, 255, 255); color: rgb(62, 62, 60);&quot;&gt;Please enter the discount % between 0 and 100.&lt;/span&gt;&lt;/p&gt;</errorMessage>
                <formulaExpression>{!Indicate_discount} &lt; 101 &amp;&amp; {!Indicate_discount} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Indicate_increase</name>
            <dataType>Number</dataType>
            <defaultValue>
                <numberValue>0.0</numberValue>
            </defaultValue>
            <fieldText>Indicate increase %</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
            <scale>2</scale>
            <validationRule>
                <errorMessage>&lt;p&gt;Please enter % between 0 and 100.&lt;/p&gt;</errorMessage>
                <formulaExpression>{!Indicate_increase} &lt; 101 &amp;&amp; {!Indicate_increase} &gt;= 0</formulaExpression>
            </validationRule>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Increase</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <fields>
            <name>Recurring_discount_for_all</name>
            <choiceReferences>Recurring_Discount_CS</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Recurring discount?</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
            <visibilityRule>
                <conditionLogic>and</conditionLogic>
                <conditions>
                    <leftValueReference>txt_p_ChoiceType</leftValueReference>
                    <operator>EqualTo</operator>
                    <rightValue>
                        <stringValue>Decrease</stringValue>
                    </rightValue>
                </conditions>
            </visibilityRule>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_products_for_price_change</name>
        <label>Select products for price change</label>
        <locationX>1570</locationX>
        <locationY>1454</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Selected_One_off_to_string</targetReference>
        </connector>
        <fields>
            <name>txt_a_SelectOneOffProductsForDiscount</name>
            <fieldText>&lt;p&gt;Please select below One-off products that will reflect the price change.&lt;/p&gt;&lt;p&gt;Note that you can select more than 1 product. &lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Products_OneOff</name>
            <choiceReferences>set_a_OneOffLineItems</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Products</fieldText>
            <fieldType>MultiSelectPicklist</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Select_products_for_price_change_MRR</name>
        <label>Select products for price change</label>
        <locationX>1544</locationX>
        <locationY>411</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Selected_MRR_products_to_string</targetReference>
        </connector>
        <fields>
            <name>introProductsForPartialDiscount</name>
            <fieldText>&lt;p&gt;Please select below products that you would like to change the price of.&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <fields>
            <name>Products</name>
            <choiceReferences>set_a_MRRLineItems</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Products</fieldText>
            <fieldType>MultiSelectPicklist</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Is_it_recurring_discount</name>
            <choiceReferences>Recurring_Discount_CS</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Is it recurring price change? If yes, then it will be replicated on the next renewal opportunity.</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>3136</locationX>
        <locationY>515</locationY>
        <connector>
            <targetReference>scr_Introduction</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <description>Contains Total Default Price of all MRR products from the opportunity. Used in the Amount branch.</description>
        <name>cur_DefaultPriceAllARRProducts</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>4</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Contains Total Default Price of all One-Off products from the opportunity. Used in the Amount branch.</description>
        <name>cur_DefaultPriceAllOneOffProducts</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>4</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Stores Sales Price of the selected product.</description>
        <name>cur_SalesPrice</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>4</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Indicates total Sales Price of all selected products.</description>
        <name>cur_TotalSalesPriceSelectedProducts</name>
        <dataType>Currency</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>4</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>curOpportunity</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Loop_All_OLI</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>Loop_OLI_MRR</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <name>Loop_OLI_OneOff</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>Indicates quantity of the selected product.</description>
        <name>num_a_QuantitySelectedProduct</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <description>Counts how many OLIs are in the loop. Used for calculating average discount.</description>
        <name>num_p_CounterMRRLineItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Indicates how many One-off products.</description>
        <name>num_p_CounterOneOffLineItems</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Indicates current MRR discount from all products. Later used for calculating an average discount.</description>
        <name>num_p_CurrentMRRDiscount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Indicates the sum of custom discount from all One-off items.</description>
        <name>num_p_CurrentOneOffDiscount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <description>Percentage branch. Record collection all Opportunity Line Items.</description>
        <name>rec_col_AllOpportunityLineItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>Record collection that returns all MRR Opportunity Line Items from the opportunity.</description>
        <name>rec_col_MRROpportunityLineItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>Returns list of products that will be updated to accommodate the price change. Used in all branches that have selected products logic.</description>
        <name>rec_col_OLIToUpdate</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>Record collection that returns all One-Off Opportunity Line Items from the opportunity.</description>
        <name>rec_col_OneOffOpportunityLineItems</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>Contains Opportunity Line Items for selected products. Used in both amount and percentage branches.</description>
        <name>rec_col_OpportunityLineItemsForSelectedLogic</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OpportunityLineItem</objectType>
    </variables>
    <variables>
        <description>This is the opportunity that the user is working with. used in both percentage and amount branches.</description>
        <name>rec_CurrentOpportunity</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <description>Returns string of selected products without any additional symbols. Need this element to be able to adjust it at a later stage, which is why original formula - txt_RawProductsCleaned - has to be assigned to this element.</description>
        <name>str_both_SelectedRawProducts</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Collection of text IDs of selected products. Used in both branches.</description>
        <name>txt_col_SelectedProductsID</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Indicates whether the user selected increase or decrease of the price.</description>
        <name>txt_p_ChoiceType</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <description>Contains IDs of all selected products in a text format. Later this data is transformed into a collection.</description>
        <name>txt_RawSelectedProducts</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
